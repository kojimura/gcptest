#-------------------
redis
#-------------------
# Create a Memorystore for Redis instance by using the Google Cloud console

# monitor alert

https://cloud.google.com/memorystore/docs/redis/monitor-instances#set_an_alert_for_high_redis_engine_cpu_utilization
Enter a decimal value between 0 and 1 to indicate the threshold percentage. For example .35 indicates 35%


#-------------------
artifact registry
#-------------------
containeranalysis.occurrences.list

gcloud projects get-iam-policy [PROJECT_ID] \
  --flatten="bindings[].members" \
  --format='table(bindings.role)' \
  --filter="bindings.members:[ACCOUNT_EMAIL]"

gcloud iam roles describe roles/owner|grep containeranalysis

https://cloud.google.com/artifact-analysis/docs/access-control
https://cloud.google.com/iam/docs/roles-overview?hl=ja

gcloud artifacts repositories list --format="table(name,location,projectId)"

gcloud artifacts repositories describe [REPOSITORY_NAME] --location=[REGION]

gcloud services list --enabled --project=[PROJECT_ID] | grep containeranalysis

gcloud policy-troubleshoot iam troubleshoot --help

gcloud policy-troubleshoot iam //artifactregistry.googleapis.com/projects/PROJECT_ID/locations/asia-northeast1/repositories/REPO_NAME \
  --permission=artifactregistry.repositories.downloadArtifacts \
  --resource-type=artifactregistry.googleapis.com/Repository \
  --principal-email="E_MAIL"

#-------------------
asset inventory
#-------------------
gcloud asset query \
   --folder=[フォルダID] \
    --statement="
      SELECT
        name, assetType
      FROM
         sqladmin_googleapis_com_Instance
      LIMIT 2"

gcloud asset search-all-resources \
   --scope='folders/[フォルダID]' \
   --asset-types='sqladmin.googleapis.com/Instance' \
   --order-by='createTime' --read-mask="*" \
   --format="table(name, versionedResources.resource.region, versionedResources.resource.databaseInstalledVersion, state, versionedResources.resource.settings.activationPolicy)"

[1] https://cloud.google.com/asset-inventory/docs/query-assets-with-sql?hl=ja
[2] https://cloud.google.com/asset-inventory/docs/search-resources?hl=ja#gcloud

